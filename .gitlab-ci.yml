workflow:
  rules:
    # take attention BASE_URL ended with /api (i.e. https://overbookd.${DOMAINE}/api)
    - if: '$CI_COMMIT_REF_NAME== "main"'
      variables:
        BASE_URL: $BASE_URL_PROD
    - if: '$CI_COMMIT_REF_NAME == "pre-prod"'
      variables:
        BASE_URL: $BASE_URL_PREPROD

stages:
  - test
  - setup
  - docker-frontend
  - docker-backend

include:
  - template: 'Workflows/Branch-Pipelines.gitlab-ci.yml'
  - template: Security/SAST.gitlab-ci.yml
  - template: Security/Secret-Detection.gitlab-ci.yml
  - local: /.gitlab/ci/buildxSetup.gitlab-ci.yml
  - local: /.gitlab/ci/frontend_containerize.gitlab-ci.yml
  - local: /.gitlab/ci/backend_containerize.gitlab-ci.yml
